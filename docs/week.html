<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="theme-color" content="#0b0c10"/>
  <title>Week Preview — Homeschool Planner</title>
  <link rel="icon" type="image/png" href="images/ico.png"/>
  <link rel="stylesheet" href="landing.css"/>
  <link rel="stylesheet" href="demo.css"/>
  <script>
/* Scholar/Forge first-visit default + live-follow if no user choice */
(function () {
  var KEY = 'sf_theme';              // persisted user choice, if any
  var root = document.documentElement;
  var saved = null;

  try { saved = localStorage.getItem(KEY); } catch(_) {}

  // Decide initial mode
  var mode = saved;
  if (!mode) {
    // If the browser reports a preference, map dark→forge, light→scholar
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      mode = 'forge';
    } else {
      // Unknown/unsupported ⇒ default to Scholar (light)
      mode = 'scholar';
    }
  }

  root.setAttribute('data-theme', mode);

  // If the user hasn't chosen yet, reflect OS changes live
  if (!saved && window.matchMedia) {
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    var onChange = function (e) {
      // Only follow if the user still hasn't picked a theme
      try { if (!localStorage.getItem(KEY)) {
        root.setAttribute('data-theme', e.matches ? 'forge' : 'scholar');
      }} catch(_) {}
    };
    if (mql.addEventListener) mql.addEventListener('change', onChange);
    else if (mql.addListener) mql.addListener(onChange); // Safari/legacy
  }
})();
  </script>
</head>
<body>
  <div id="hdr"></div>  <!-- header goes here -->

  <!-- week preview demo using shared tokens -->
  <div class="app">
    <header class="appbar">
      <div class="bar"><h1>Week Preview — Allen</h1></div>
    </header>

    <main>
      <section class="card pad">
        <div class="chips">
          <span class="pill">Target 180m/day</span>
          <span class="pill">Planned 175m avg</span>
        </div>
        <div class="days">
          <button class="daychip active">Mon 9</button><button class="daychip">Tue 10</button>
          <button class="daychip">Wed 11</button><button class="daychip">Thu 12</button><button class="daychip">Fri 13</button>
        </div>
      </section>

      <section class="card pad week" aria-label="Week cards">
        <div class="day">
          <div class="day-h"><div><strong>Mon</strong> <span class="muted">• 175m</span></div>
            <a class="btn" href="day.html" aria-label="Open Monday detail">Open ▸</a></div>
          <div class="blocks">
            <div class="block">English 35m</div><div class="block">History 60m</div>
            <div class="block">Math (Saxon) 60m</div><div class="block">Piano 20m</div>
          </div>
        </div>

        <div class="day">
          <div class="day-h"><div><strong>Tue</strong> <span class="muted">• 175m</span></div>
            <a class="btn" href="day.html">Open ▸</a></div>
          <div class="blocks">
            <div class="block">English 35m</div><div class="block">History 60m</div>
            <div class="block warn">△ Back-to-back 120m without break — insert 10m</div>
            <div class="block">Math (Saxon) 60m</div><div class="block">Piano 20m</div>
          </div>
        </div>

        <!-- Wed/Thu/Fri … same pattern -->
        <div class="day">
          <div class="day-h"><div><strong>Wed</strong> <span class="muted">• 175m</span></div>
            <a class="btn" href="day.html">Open ▸</a></div>
          <div class="blocks"><div class="block">English 35m</div><div class="block">History 60m</div>
            <div class="block">Math (Saxon) 60m</div><div class="block">Piano 20m</div></div>
        </div>

        <div class="day">
          <div class="day-h"><div><strong>Thu</strong> <span class="muted">• 175m</span></div>
            <a class="btn" href="day.html">Open ▸</a></div>
          <div class="blocks"><div class="block">English 35m</div><div class="block">History 60m</div>
            <div class="block">Math (Saxon) 60m</div><div class="block">Piano 20m</div></div>
        </div>

        <div class="day">
          <div class="day-h"><div><strong>Fri</strong> <span class="muted">• 175m</span></div>
            <a class="btn" href="day.html">Open ▸</a></div>
          <div class="blocks"><div class="block">English 35m</div><div class="block">History 60m</div>
            <div class="block">Math (Saxon) 60m</div><div class="block">Piano 20m</div></div>
        </div>
      </section>

      <section class="card pad">
        <div class="chips mb-075">
          <button class="chip" id="sug-hist">Apply: History M/W/F</button>
          <button class="chip" id="sug-sci">Apply: Science T/Th</button>
        </div>
        <button class="btn primary w-full" id="autobal">Auto-balance to fit daily target →</button>
      </section>
    </main>

    <div class="toast" id="toast" role="status" aria-live="polite">Applied suggestion.</div>
  </div>

  <div id="ftr"></div>  <!-- footer goes here -->

  <script>
const applyPartial = (placeholderId, html, root) => {
  const tpl = document.createElement('template');
  tpl.innerHTML = html.trim();
  const element = tpl.content.firstElementChild;
  if (!element) { return; }

  const toAbsolute = (value) => {
    if (!value || value.startsWith('#') || value.startsWith('//') || /^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(value) || value.startsWith('/')) {
      return value;
    }
    const clean = value.replace(/^\.\/+/, '');
    return root ? `${root}/${clean}` : clean;
  };

  element.querySelectorAll('[href]').forEach((node) => {
    const original = node.getAttribute('href');
    const adjusted = toAbsolute(original);
    if (adjusted !== original) {
      node.setAttribute('href', adjusted);
    }
  });

  element.querySelectorAll('[src]').forEach((node) => {
    const original = node.getAttribute('src');
    const adjusted = toAbsolute(original);
    if (adjusted !== original) {
      node.setAttribute('src', adjusted);
    }
  });

  const placeholder = document.getElementById(placeholderId);
  if (placeholder) {
    placeholder.replaceWith(element);
  }
};

(async () => {
  const root = location.pathname.startsWith('/docs') ? '/docs' : '';
  const h = await fetch(`${root}/partials/header.html`).then(r=>r.text());
  const f = await fetch(`${root}/partials/footer.html`).then(r=>r.text());
  applyPartial('hdr', h, root);
  applyPartial('ftr', f, root);
  const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
  if (window.setupModeToggle) window.setupModeToggle();
})();
  </script>
  <script>
/* Segmented “Scholar / Forge” toggle → persist user choice */
window.setupModeToggle = function () {
  var KEY = 'sf_theme';
  var root = document.documentElement;
  var bScholar = document.getElementById('mode-scholar');
  var bForge   = document.getElementById('mode-forge');

  if (!bScholar || !bForge) {
    return;
  }

  if (bScholar.dataset.bound === 'true' || bForge.dataset.bound === 'true') {
    return;
  }

  bScholar.dataset.bound = 'true';
  bForge.dataset.bound = 'true';

  function setMode(mode, persist) {
    root.setAttribute('data-theme', mode);
    if (persist) {
      try { localStorage.setItem(KEY, mode); } catch(_) {}
    }
    bScholar.classList.toggle('active', mode === 'scholar');
    bForge.classList.toggle('active',   mode === 'forge');
    bScholar.setAttribute('aria-selected', mode === 'scholar');
    bForge.setAttribute('aria-selected',   mode === 'forge');
  }

  bScholar.addEventListener('click', function(){ setMode('scholar', true); });
  bForge.addEventListener('click',   function(){ setMode('forge',   true); });

  // Ensure the segmented control reflects whatever the head script chose
  setMode(root.getAttribute('data-theme') || 'scholar', false);
};

document.addEventListener('DOMContentLoaded', function () {
  if (window.setupModeToggle) window.setupModeToggle();
});
  </script>
  <script>
  const toast=document.getElementById('toast');
  function showToast(msg){ toast.textContent=msg; toast.style.display='block';
    setTimeout(()=>toast.style.display='none',1600); }
  document.getElementById('sug-hist').onclick = ()=>showToast('History set to M/W/F');
  document.getElementById('sug-sci').onclick  = ()=>showToast('Science set to T/Th');
  document.getElementById('autobal').onclick  = ()=>showToast('Auto-balanced to target');
  </script>
</body>
</html>
